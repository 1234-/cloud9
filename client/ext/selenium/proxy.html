<!DOCTYPE html>
<html>
    <head>
        <script>//<!--
            window.onload = function(){
                var iframe = document.getElementById("proxyframe");
                var target = iframe.contentWindow;
                var timer;
            
                window.addEventListener("message", function(e) {
//                    if (e.origin !== window.parent.location.origin)
//                        return;
                    
                    try {
                        var json = typeof e.data == "string" ? JSON.parse(e.data) : e.data;
                    } catch (e) { return; }
                    
                    if (json.type == "href") {
                        if (target.location.href != json.href)
                            target.location.href = json.href;
                    }
                    else if (json.type == "inject") {
                        if (!target.capture) {
                            var head = target.document.documentElement;
                            elScript = target.document.createElement("script");
                            elScript.src = json.href;
                            head.appendChild(elScript);
                        }
                    }
                    else
                        target.postMessage(e.data, "*");
                }, false);
                
                window.addEventListener("message", function(e) {
                    if (e.origin !== target.location.origin)
                        return;
                    
                    window.parent.postMessage(e.data, "*");
                }, false);
                
                iframe.addEventListener("load", function(){
                    window.parent.postMessage(JSON.stringify({
                        type : "load",
                        href : target.location.href
                    }), "*");
                });
                
                iframe.addEventListener("error", function(){
                    window.parent.postMessage(JSON.stringify({
                        type : "error",
                        href : target.location.href
                    }), "*");
                });
            }
        //--></script>
    </head>
    <body>
        <iframe id="proxyframe" frameBorder="0" style="position:absolute;left:0;top:0;width:100%;height:100%">
        </iframe>
    </body>
</html>
